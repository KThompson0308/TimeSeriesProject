irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
conames(irx2) <- c("Date","irxclose")
irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
colnames(irx2) <- c("Date","irxclose")
final = right_join(apple, irx2, keep=TRUE)
View(final)
irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
colnames(irx2) <- c("Date","irxclose")
final = right_join(apple, irx2,by="Date" keep=TRUE)
irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
colnames(irx2) <- c("Date","irxclose")
final = right_join(apple, irx2,by="Date", keep=TRUE)
irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
colnames(irx2) <- c("Date","irxclose")
final = right_join(apple, irx2,by="Date", keep=TRUE, copy=TRUE)
View(final)
irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
colnames(irx2) <- c("Date","irxclose")
final = right_join(apple, irx2, by="Date")
View(final)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
apple <- read_csv("AAPL.csv")
irx <- read.csv("IRX.csv")
summary(apple)
irx2 <- drop_na(irx, `Adj Close`) %>% select(c(Date, `Adj Close`))
summary(apple)
summary(irx)
irx2 <- drop_na(irx, Close) %>% select(c(Date, `Adj Close`))
irx2 <- drop_na(irx, Close) %>% select(c(Date, Close))
colnames(irx2) <- c("Date","irxclose")
final = right_join(apple, irx2, by="Date")
View(final)
View(irx2)
summary(irx2)
summary(irx)
irx2 <- drop_na(irx, Close) %>% select(c(Date, Close))
irx2$Close <- as.numeric(irx2$Close)
final = right_join(apple, irx2)
View(final)
irx2 <- drop_na(irx, Close) %>% select(c(Date, Close))
irx2$Close <- as.numeric(irx2$Close)
final = right_join(apple, irx2, by="Date")
irx$Close <- as.numeric(irx2$Close)
irx2 <- drop_na(irx, Close) %>% select(c(Date, Close))
final = right_join(apple, irx2, by="Date")
View(final)
summary(apple)
summary(irx)
summary(apple)
View(apple)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
apple <- read_csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
summary(apple)
summary(irx)
summary(apple)
View(apple)
View(irx)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
summary(apple)
summary(irx)
irx$Close <- as.numeric(irx2$Adj.Close)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
summary(irx)
irx$Adj.Close <- as.numeric(irx2$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
final = right_join(apple, irx2, by="Date")
View(final)
ccf(final$Adj.Close.y, final$Adj.Close.x)
d1irx = artrans.wge(final$Adj.Close.y, phi.tr=1)
d1aapl = artrans.wge(final$Adj.Close.x, phi.tr=1)
ccf(d1irx, d1aapl)
d1irx = artrans.wge(final$Adj.Close.y, phi.tr=1, plottr=FALSE)
d1aapl = artrans.wge(final$Adj.Close.x, phi.tr=1,plottr = FALSE)
ccf(d1irx, d1aapl)
?tswge::artrans.wge
d1irx = artrans.wge(final$Adj.Close.y, phi.tr=1, plottr="FALSE")
d1aapl = artrans.wge(final$Adj.Close.x, phi.tr=1,plottr = "FALSE")
ccf(d1irx, d1aapl)
d1irx = artrans.wge(final$Adj.Close.y, phi.tr=1)
d1aapl = artrans.wge(final$Adj.Close.x, phi.tr=1)
ccf(d1irx,d1aapl)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
fvx <- read.csv("kdata/FVX.csv")
summary(fvx)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% select(c(Date, Adj.Close))
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
View(final)
?colnames
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% select(c(Date, Adj.Close))
colnames(irx2) <- c("Date", "IRX")
colnames(fvx2) <- c("Date", "FVX")
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
View(final)
?mutate
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% select(c(Date, Adj.Close))
colnames(irx2) <- c("Date", "IRX")
colnames(fvx2) <- c("Date", "FVX")
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
final <- final %>% mutate(rel_yield = FVX/IRX)
View(final)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% select(c(Date, Adj.Close))
colnames(irx2) <- c("Date", "IRX")
colnames(fvx2) <- c("Date", "FVX")
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
final <- final %>% mutate(rel_yield = FVX/IRX)
d1aapl = artrans.wge(final$Adj.Close, phi.tr=1)
ccf(final$rel_yield,d1aapl)
d1aapl = artrans.wge(final$Adj.Close, phi.tr=1)
d1rel = artrans.wge(final$rel_yield, phi.tr=1)
ccf(d1rel,d1aapl)
ccf(final$rel_yield,d1aapl)
ccf(final$IRX,d1aapl)
ccf(final$FVX,d1aapl)
ccf(final$FVX,final$Adj.Close)
d1aapl = artrans.wge(final$Adj.Close, phi.tr=1)
d1fvx = artrans.wge(final$FVX, phi.tr=1)
ccf(d1fvx, d1aapl)
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
aic5.wge(mod1$residuals)
?arima
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
#aic5.wge(mod1$residuals) yields ARIMA(2,1,0)
arimamod1 <- arima(Adj.Close,order = c(2,1,0),xreg=final %>% select(c(IRX, FVX)))
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
#aic5.wge(mod1$residuals) yields ARIMA(2,1,0)
arimamod1 <- arima(final$Adj.Close,order = c(2,1,0),xreg=final %>% select(c(IRX, FVX)))
tswge::ljung.wge(arimamod1$residuals)
summary(arimamod1)
broom::tidy(arimamod1)
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
#aic5.wge(mod1$residuals) yields ARIMA(2,1,0)
arimamod1 <- arima(final$Adj.Close,order = c(2,1,0),xreg=final %>% select(c(FVX)))
tswge::ljung.wge(arimamod1$residuals)
broom::tidy(arimamod1)
ccf(d1fvx, d1aapl)
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
#aic5.wge(mod1$residuals) yields ARIMA(2,1,0)
arimamod1 <- arima(final$Adj.Close,order = c(2,1,0),xreg=final %>% select(c(IRX, FVX)))
tswge::ljung.wge(arimamod1$residuals)
broom::tidy(arimamod1)
final_lag = final
?dplyr::lag
final_lag = final
final_lag = final_lag$FVX %>% dplyr::lag(n=1)
d1fvxlag1 = artrans.wge(final_lag$FVX)
final_lag = final
final_lag = final_lag$FVX %>% dplyr::lag(n=1)
d1fvxlag1 = artrans.wge(final_lag$FVX, phi.tr=1)
final_lag = final
final_lag$FVX = final_lag$FVX %>% dplyr::lag(n=1)
d1fvxlag1 = artrans.wge(final_lag$FVX, phi.tr=1)
final = final %>% mutate(fvxlag1 = lag(FVX, n=1))
d1fvxlag1 = artrans.wge(final$fvxlag1, phi.tr=1)
View(final)
final = final %>% mutate(fvxlag1 = lag(FVX, n=1))
d1fvxlag1 = artrans.wge(final$fvxlag1, phi.tr=1)
fvxlag1 = dplyr::lag(final$FVX, n=1)
d1fvxlag1 = artrans.wge(fvxlag1, phi.tr=1)
fvxlag1 = dplyr::lag(final$FVX, n=1)
d1fvxlag1 = artrans.wge(fvxlag1[2:], phi.tr=1)
fvxlag1 = dplyr::lag(final$FVX, n=1)
d1fvxlag1 = artrans.wge(fvxlag1[-1], phi.tr=1)
ccf(d1fvxlag1, d1aapl)
fvxlag1 = dplyr::lag(final$FVX, n=1)
d1fvxlag1 = artrans.wge(fvxlag1[-1], phi.tr=1)
ccf(d1fvxlag1, d1aapl)
d1fvxlag1 = d1fvx %>% lag(n=1)
ccf(d1fvxlag1, d1aapl)
d1fvxlag1 = d1fvx %>% lag(n=1)
ccf(d1fvxlag1, d1aapl,na.action = na.pass)
?na.pass
d1fvxlag1 = d1fvx %>% lag(n=1)
ccf(d1fvxlag1, d1aapl,na.action = na.omit)
d1fvxlag1 = d1fvx %>% lag(n=1)
ccf(d1fvxlag1, d1aapl,na.action = na.exclude)
d1fvxlag1 = d1fvx %>% lag(n=1)
ccf(d1fvxlag1, d1aapl,na.action = na.pass)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
fvx <- read.csv("kdata/FVX.csv")
ixic <- read.csv("kdata/IXIC.csv")
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% select(c(Date, Adj.Close))
colnames(ixic2) <- c("Date", "IXIC")
colnames(irx2) <- c("Date", "IRX")
colnames(fvx2) <- c("Date", "FVX")
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
final = right_join(final, ixic2, by="Date")
final <- final %>% mutate(rel_yield = FVX/IRX)
View(final)
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
irx2 <- drop_na(irx, Adj.Close) %>% select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% select(c(Date, Adj.Close))
colnames(ixic2) <- c("Date", "IXIC")
colnames(irx2) <- c("Date", "IRX")
colnames(fvx2) <- c("Date", "FVX")
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
final = left_join(final, ixic2, by="Date")
final <- final %>% mutate(rel_yield = FVX/IRX)
View(final)
d1aapl = artrans.wge(final$Adj.Close, phi.tr=1)
d1fvx = artrans.wge(final$FVX, phi.tr=1)
d1ixic = artrans.wge(final$IXIC, phi.tr=1)
ccf(d1ixic, d1aapl)
mod1 <- lm(Adj.Close ~ IRX+FVX, data=final)
#aic5.wge(mod1$residuals) yields ARIMA(2,1,0)
arimamod1 <- arima(final$Adj.Close,order = c(2,1,0),xreg=final %>% select(c(IRX, FVX, IXIC)))
tswge::ljung.wge(arimamod1$residuals)
broom::tidy(arimamod1)
X = cbind(d1ixic,d1fvx,d1aapl)
VARSelect(X, log.max=6, type="const")
library(vars)
X = cbind(d1ixic,d1fvx,d1aapl)
VARSelect(X, log.max=6, type="const")
library(vars)
X = cbind(d1ixic,d1fvx,d1aapl)
VARselect(X, log.max=6, type="const")
library(vars)
X = cbind(d1ixic,d1fvx,d1aapl)
VARselect(X, lag.max = 6, type="const")
library(vars)
X = cbind(d1ixic,d1fvx,d1aapl)
VARselect(X, lag.max = 10, type="const")
library(vars)
X = cbind(d1ixic,d1fvx,d1aapl)
VARselect(X, lag.max = 12, type="const")
library(vars)
X = cbind(d1ixic,d1fvx,d1aapl)
VARselect(X, lag.max = 10, type="const")
varfit = VAR(X, p=9, type="const")
Y = read.csv("Appl.data.csv")
VARSELECT(Y, lag.max=10, type="const")
Y = read.csv("Appl.data.csv")
VARselect(Y, lag.max=10, type="const")
View(Y)
Y = read.csv("Appl.data.csv")
VARselect(Y %>% select(-c(Date)), lag.max=10, type="const")
Y = read.csv("Appl.data.csv")
Y = Y %>% select(-c(Date))
Y = read.csv("Appl.data.csv")
Y = Y %>% select_if(.isnumeric)
Y = read.csv("Appl.data.csv")
Y = Y %>% select_if(is.numeric)
VARselect(Y, lag.max=10, type="const")
varsinkfit = VAR(Y, p=4, type="const")
dim(varsinkfit)
length(varsinkfit$datamat)
dim(varsinkfit$datamat)
View(Y)
dim(varsinkfit$y)
dim(varsinkfit$y)
class(varsinkfit)
mod1$rank
mod1$fitted.values
dimmod1$fitted.values)
dim(mod1$fitted.values)
length(mod1$fitted.values)
?pred
?predict
Y[2]
Y[:,2]
Y[,2]
Y[,2:3]
install.packages("bigtime")
install.packages("rugarch")
#chooseCRANmirror(graphics=FALSE, ind=1)
knitr::opts_chunk$set(echo = TRUE)
#pkgs <- c("tswge", "dplyr", "tseries", "orcutt", "tidyverse","corrplot", "GGally", "ggplot2","nnfor","neuralnet")
#install.packages(pkgs, repos = "http://cran.us.r-project.org")
library(tswge)
library(dplyr)
library(tseries)
library(orcutt)
library(tidyverse)
library(corrplot)
library(GGally)
library(ggplot2)
library(nnfor)
library(neuralnet)
### loading the data
APPL = read.csv("AAPL.csv", header = TRUE)
DXY = read.csv("DX-Y.NYB.csv", header = TRUE)
CAC40 = read.csv("CAC40.csv", header = TRUE)
Gold = read.csv("GC=F.csv", header = TRUE)
Copper = read.csv("HG=F.csv", header = TRUE)
CQQQ = read.csv("CQQQ.csv", header = TRUE)
TNYR = read.csv("TNX.csv", header = TRUE)
WTI = read.csv("CL=F.csv", header = TRUE)
NASDAQ = read.csv("IXIC.csv", header = TRUE)
### APPL - Date & Adj.Close
head(APPL)
APPL = APPL %>% dplyr::select(Date, Adj.Close)
APPL$Date = as.Date(APPL$Date, "%m/%d/%Y")
summary(APPL)
### Dollar Index - Date & Adj.Close
head(DXY)
DXY = DXY %>% dplyr::select(Date, Adj.Close)
DXY$Adj.Close = as.numeric(DXY$Adj.Close)
DXY$Date = as.Date(DXY$Date, "%m/%d/%Y")
summary(DXY)
### FTSE (Financial Times Index at London) - Date & Adj.Close
head(CAC40)
CAC40 = CAC40 %>% dplyr::select(Date, Adj.Close)
CAC40$Adj.Close = as.numeric(CAC40$Adj.Close)
CAC40$Date = as.Date(CAC40$Date, "%m/%d/%Y")
summary(CAC40)
### Gold (commodity price) - Date & Adj.Close
head(Gold)
Gold = Gold %>% dplyr::select(Date, Adj.Close)
Gold$Adj.Close = as.numeric(Gold$Adj.Close)
Gold$Date = as.Date(Gold$Date, "%m/%d/%Y")
summary(Gold)
### Copper (commodity price) - Date & Adj.Close
head(Copper)
Copper = Copper %>% dplyr::select(Date, Adj.Close)
Copper$Adj.Close = as.numeric(Copper$Adj.Close)
Copper$Date = as.Date(Copper$Date, "%m/%d/%Y")
summary(Copper)
### CQQQ (Invesco China Technology ETF - Proxy of chinese tech stock)
head(CQQQ)
CQQQ = CQQQ %>% dplyr::select(Date, Adj.Close)
CQQQ$Adj.Close = as.numeric(CQQQ$Adj.Close)
CQQQ$Date = as.Date(CQQQ$Date, "%m/%d/%Y")
summary(CQQQ)
### 10 year Treasury note
head(TNYR)
TNYR = TNYR %>% dplyr::select(Date, Adj.Close)
TNYR$Adj.Close = as.numeric(TNYR$Adj.Close)
TNYR$Date = as.Date(TNYR$Date, "%m/%d/%Y")
summary(TNYR)
### WTI Crude
head(WTI)
WTI = WTI %>% dplyr::select(Date, Adj.Close)
WTI$Adj.Close = as.numeric(WTI$Adj.Close)
WTI$Date = as.Date(WTI$Date, "%m/%d/%Y")
summary(WTI)
### NASDAQ index
head(NASDAQ)
NASDAQ = NASDAQ %>% dplyr::select(Date, Adj.Close)
NASDAQ$Adj.Close = as.numeric(NASDAQ$Adj.Close)
NASDAQ$Date = as.Date(NASDAQ$Date, "%m/%d/%Y")
summary(NASDAQ)
### Creating data set - joining Apple, Nasdaq, wti, gold, copper
Appl.df = list(APPL,NASDAQ,WTI, Gold, Copper) %>% reduce(inner_join, by = 'Date')
names(Appl.df)[2] = 'APPL'
names(Appl.df)[3] = 'NASDAQ'
names(Appl.df)[4] = 'WTI'
names(Appl.df)[5] = 'Gold'
names(Appl.df)[6] = 'Copper'
summary(Appl.df)
head(Appl.df)
dim(Appl.df) #--- 1509, 6
### Creating dataset - joining TNYR and DXY
tnxy = inner_join(TNYR, DXY, by = 'Date')
names(tnxy)[2] = 'TNYR'
names(tnxy)[3] = 'DXY'
summary(tnxy)
dim(tnxy) # --- 1824, 3
### Creating final dataset
Appl.data = list(Appl.df, tnxy, CQQQ,CAC40) %>% reduce(inner_join, by = 'Date')
names(Appl.data)[9] = 'CQQQ'
names(Appl.data)[10] = 'CAC40'
summary(Appl.data)
dim(Appl.data) ## ---1494, 10
###--------------------Imputing NAs
## Logic: use the average of preceeding and following values of NAs
Appl.data$WTI = 0.5*(na.locf(Appl.data$WTI,fromlast=TRUE) + na.locf(Appl.data$WTI))
Appl.data$Gold = 0.5*(na.locf(Appl.data$Gold,fromlast=TRUE) + na.locf(Appl.data$Gold))
Appl.data$Copper = 0.5*(na.locf(Appl.data$Copper,fromlast=TRUE) + na.locf(Appl.data$Copper))
Appl.data$TNYR = 0.5*(na.locf(Appl.data$TNYR,fromlast=TRUE) + na.locf(Appl.data$TNYR))
Appl.data$DXY = 0.5*(na.locf(Appl.data$DXY,fromlast=TRUE) + na.locf(Appl.data$DXY))
summary(Appl.data)
### Corelation plots
# ggpair plot for correlation
Appl.data %>%
ggpairs(columns=c("APPL","NASDAQ","WTI","Gold", "Copper","TNYR","DXY","CQQQ","CAC40"),
upper = list(continuous = "cor", combo = "box_no_facet", discrete = "count", na =
"na"),
lower = list(continuous = "points", combo = "facethist", discrete = "facetbar", na =
"na"),
diag = list(continuous = "densityDiag", discrete = "barDiag", na = "naDiag"))
head(Appl.data)
Appl.data.nn = Appl.data[,-1] ## removing Date
str(Appl.data.nn)
## Min-Max normalization of the dataset
Appl.data.norm = Appl.data.nn
for(i in 1:9){
Appl.data.norm[,i] = (Appl.data.nn[,i] - min(Appl.data.nn[,i]))/
(max(Appl.data.nn[,i]) -min(Appl.data.nn[,i]))
}
####    7 days ASE  ----------------------
train.Appl.data.7 = Appl.data.norm[1:1487,]
test.Appl.data.7 = Appl.data.norm[1488:1494,]
fit.net.7 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI +
Gold + Copper + TNYR + DXY + CQQQ + CAC40,
data = train.Appl.data.7, hidden = c(5,3),
linear.output=FALSE)
plot(fit.net.7)
out.test.7 = compute(fit.net.7, test.Appl.data.7[,2:9]) # prediction
## reverting the values by retrofiting the min-max normalization
pred.7 = out.test.7$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.7 = Appl.data.nn[1488:1494,1]
ASE.nn.7 = sum((pred.7 -actual.7)^2)/nrow(test.Appl.data.7)
ASE.nn.7
plot(seq(1,107,1),Appl.data.nn$APPL[1388:1494], type = 'l', xlim= c(1,115))
lines(seq(101,107,1), pred.7, col = 'blue')
####    30 days ASE   ---------------------------
train.Appl.data.30 = Appl.data.norm[1:1464,]
test.Appl.data.30 = Appl.data.norm[1465:1494,]
fit.net.30 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI + Gold + Copper + TNYR + DXY + CQQQ + CAC40, data = train.Appl.data.7, hidden = c(5,3),  linear.output=FALSE)
plot(fit.net.30)
out.test.30 = compute(fit.net.30, test.Appl.data.30[,2:9])
# reverting to normal forecasting values
pred.30 = out.test.30$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.30 = Appl.data.nn[1465:1494,1]
ASE.nn.30 = sum((pred.30 -actual.30)^2)/nrow(test.Appl.data.30)
ASE.nn.30
plot(seq(1,130,1),Appl.data.nn$APPL[1365:1494], type = 'l', xlim = c(1,115))
lines(seq(101,130,1), pred.30, col = 'blue')
###====================================================================
### 7 days forecast of individual parameter using mlp (nueral net) ====
# APPL - 7days forecast
fit.mlp.APPL = mlp(APPL,reps = 50,comb = "mean")
head(Appl.data)
Appl.data.nn = Appl.data[,-1] ## removing Date
str(Appl.data.nn)
## Min-Max normalization of the dataset
Appl.data.norm = Appl.data.nn
for(i in 1:9){
Appl.data.norm[,i] = (Appl.data.nn[,i] - min(Appl.data.nn[,i]))/
(max(Appl.data.nn[,i]) -min(Appl.data.nn[,i]))
}
####    7 days ASE  ----------------------
train.Appl.data.7 = Appl.data.norm[1:1487,]
test.Appl.data.7 = Appl.data.norm[1488:1494,]
fit.net.7 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI +
Gold + Copper + TNYR + DXY + CQQQ + CAC40,
data = train.Appl.data.7, hidden = c(5,3),
linear.output=FALSE)
plot(fit.net.7)
out.test.7 = compute(fit.net.7, test.Appl.data.7[,2:9]) # prediction
## reverting the values by retrofiting the min-max normalization
pred.7 = out.test.7$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.7 = Appl.data.nn[1488:1494,1]
ASE.nn.7 = sum((pred.7 -actual.7)^2)/nrow(test.Appl.data.7)
ASE.nn.7
plot(seq(1,107,1),Appl.data.nn$APPL[1388:1494], type = 'l', xlim= c(1,115))
lines(seq(101,107,1), pred.7, col = 'blue')
####    30 days ASE   ---------------------------
train.Appl.data.30 = Appl.data.norm[1:1464,]
test.Appl.data.30 = Appl.data.norm[1465:1494,]
fit.net.30 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI + Gold + Copper + TNYR + DXY + CQQQ + CAC40, data = train.Appl.data.7, hidden = c(5,3),  linear.output=FALSE)
plot(fit.net.30)
out.test.30 = compute(fit.net.30, test.Appl.data.30[,2:9])
# reverting to normal forecasting values
pred.30 = out.test.30$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.30 = Appl.data.nn[1465:1494,1]
ASE.nn.30 = sum((pred.30 -actual.30)^2)/nrow(test.Appl.data.30)
ASE.nn.30
plot(seq(1,130,1),Appl.data.nn$APPL[1365:1494], type = 'l', xlim = c(1,115))
lines(seq(101,130,1), pred.30, col = 'blue')
###====================================================================
### 7 days forecast of individual parameter using mlp (nueral net) ====
# APPL - 7days forecast
fit.mlp.APPL = mlp(APPL$Adj.Close,reps = 50,comb = "mean")
