Y[,2]
Y[,2:3]
install.packages("bigtime")
install.packages("rugarch")
#chooseCRANmirror(graphics=FALSE, ind=1)
knitr::opts_chunk$set(echo = TRUE)
#pkgs <- c("tswge", "dplyr", "tseries", "orcutt", "tidyverse","corrplot", "GGally", "ggplot2","nnfor","neuralnet")
#install.packages(pkgs, repos = "http://cran.us.r-project.org")
library(tswge)
library(dplyr)
library(tseries)
library(orcutt)
library(tidyverse)
library(corrplot)
library(GGally)
library(ggplot2)
library(nnfor)
library(neuralnet)
### loading the data
APPL = read.csv("AAPL.csv", header = TRUE)
DXY = read.csv("DX-Y.NYB.csv", header = TRUE)
CAC40 = read.csv("CAC40.csv", header = TRUE)
Gold = read.csv("GC=F.csv", header = TRUE)
Copper = read.csv("HG=F.csv", header = TRUE)
CQQQ = read.csv("CQQQ.csv", header = TRUE)
TNYR = read.csv("TNX.csv", header = TRUE)
WTI = read.csv("CL=F.csv", header = TRUE)
NASDAQ = read.csv("IXIC.csv", header = TRUE)
### APPL - Date & Adj.Close
head(APPL)
APPL = APPL %>% dplyr::select(Date, Adj.Close)
APPL$Date = as.Date(APPL$Date, "%m/%d/%Y")
summary(APPL)
### Dollar Index - Date & Adj.Close
head(DXY)
DXY = DXY %>% dplyr::select(Date, Adj.Close)
DXY$Adj.Close = as.numeric(DXY$Adj.Close)
DXY$Date = as.Date(DXY$Date, "%m/%d/%Y")
summary(DXY)
### FTSE (Financial Times Index at London) - Date & Adj.Close
head(CAC40)
CAC40 = CAC40 %>% dplyr::select(Date, Adj.Close)
CAC40$Adj.Close = as.numeric(CAC40$Adj.Close)
CAC40$Date = as.Date(CAC40$Date, "%m/%d/%Y")
summary(CAC40)
### Gold (commodity price) - Date & Adj.Close
head(Gold)
Gold = Gold %>% dplyr::select(Date, Adj.Close)
Gold$Adj.Close = as.numeric(Gold$Adj.Close)
Gold$Date = as.Date(Gold$Date, "%m/%d/%Y")
summary(Gold)
### Copper (commodity price) - Date & Adj.Close
head(Copper)
Copper = Copper %>% dplyr::select(Date, Adj.Close)
Copper$Adj.Close = as.numeric(Copper$Adj.Close)
Copper$Date = as.Date(Copper$Date, "%m/%d/%Y")
summary(Copper)
### CQQQ (Invesco China Technology ETF - Proxy of chinese tech stock)
head(CQQQ)
CQQQ = CQQQ %>% dplyr::select(Date, Adj.Close)
CQQQ$Adj.Close = as.numeric(CQQQ$Adj.Close)
CQQQ$Date = as.Date(CQQQ$Date, "%m/%d/%Y")
summary(CQQQ)
### 10 year Treasury note
head(TNYR)
TNYR = TNYR %>% dplyr::select(Date, Adj.Close)
TNYR$Adj.Close = as.numeric(TNYR$Adj.Close)
TNYR$Date = as.Date(TNYR$Date, "%m/%d/%Y")
summary(TNYR)
### WTI Crude
head(WTI)
WTI = WTI %>% dplyr::select(Date, Adj.Close)
WTI$Adj.Close = as.numeric(WTI$Adj.Close)
WTI$Date = as.Date(WTI$Date, "%m/%d/%Y")
summary(WTI)
### NASDAQ index
head(NASDAQ)
NASDAQ = NASDAQ %>% dplyr::select(Date, Adj.Close)
NASDAQ$Adj.Close = as.numeric(NASDAQ$Adj.Close)
NASDAQ$Date = as.Date(NASDAQ$Date, "%m/%d/%Y")
summary(NASDAQ)
### Creating data set - joining Apple, Nasdaq, wti, gold, copper
Appl.df = list(APPL,NASDAQ,WTI, Gold, Copper) %>% reduce(inner_join, by = 'Date')
names(Appl.df)[2] = 'APPL'
names(Appl.df)[3] = 'NASDAQ'
names(Appl.df)[4] = 'WTI'
names(Appl.df)[5] = 'Gold'
names(Appl.df)[6] = 'Copper'
summary(Appl.df)
head(Appl.df)
dim(Appl.df) #--- 1509, 6
### Creating dataset - joining TNYR and DXY
tnxy = inner_join(TNYR, DXY, by = 'Date')
names(tnxy)[2] = 'TNYR'
names(tnxy)[3] = 'DXY'
summary(tnxy)
dim(tnxy) # --- 1824, 3
### Creating final dataset
Appl.data = list(Appl.df, tnxy, CQQQ,CAC40) %>% reduce(inner_join, by = 'Date')
names(Appl.data)[9] = 'CQQQ'
names(Appl.data)[10] = 'CAC40'
summary(Appl.data)
dim(Appl.data) ## ---1494, 10
###--------------------Imputing NAs
## Logic: use the average of preceeding and following values of NAs
Appl.data$WTI = 0.5*(na.locf(Appl.data$WTI,fromlast=TRUE) + na.locf(Appl.data$WTI))
Appl.data$Gold = 0.5*(na.locf(Appl.data$Gold,fromlast=TRUE) + na.locf(Appl.data$Gold))
Appl.data$Copper = 0.5*(na.locf(Appl.data$Copper,fromlast=TRUE) + na.locf(Appl.data$Copper))
Appl.data$TNYR = 0.5*(na.locf(Appl.data$TNYR,fromlast=TRUE) + na.locf(Appl.data$TNYR))
Appl.data$DXY = 0.5*(na.locf(Appl.data$DXY,fromlast=TRUE) + na.locf(Appl.data$DXY))
summary(Appl.data)
### Corelation plots
# ggpair plot for correlation
Appl.data %>%
ggpairs(columns=c("APPL","NASDAQ","WTI","Gold", "Copper","TNYR","DXY","CQQQ","CAC40"),
upper = list(continuous = "cor", combo = "box_no_facet", discrete = "count", na =
"na"),
lower = list(continuous = "points", combo = "facethist", discrete = "facetbar", na =
"na"),
diag = list(continuous = "densityDiag", discrete = "barDiag", na = "naDiag"))
head(Appl.data)
Appl.data.nn = Appl.data[,-1] ## removing Date
str(Appl.data.nn)
## Min-Max normalization of the dataset
Appl.data.norm = Appl.data.nn
for(i in 1:9){
Appl.data.norm[,i] = (Appl.data.nn[,i] - min(Appl.data.nn[,i]))/
(max(Appl.data.nn[,i]) -min(Appl.data.nn[,i]))
}
####    7 days ASE  ----------------------
train.Appl.data.7 = Appl.data.norm[1:1487,]
test.Appl.data.7 = Appl.data.norm[1488:1494,]
fit.net.7 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI +
Gold + Copper + TNYR + DXY + CQQQ + CAC40,
data = train.Appl.data.7, hidden = c(5,3),
linear.output=FALSE)
plot(fit.net.7)
out.test.7 = compute(fit.net.7, test.Appl.data.7[,2:9]) # prediction
## reverting the values by retrofiting the min-max normalization
pred.7 = out.test.7$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.7 = Appl.data.nn[1488:1494,1]
ASE.nn.7 = sum((pred.7 -actual.7)^2)/nrow(test.Appl.data.7)
ASE.nn.7
plot(seq(1,107,1),Appl.data.nn$APPL[1388:1494], type = 'l', xlim= c(1,115))
lines(seq(101,107,1), pred.7, col = 'blue')
####    30 days ASE   ---------------------------
train.Appl.data.30 = Appl.data.norm[1:1464,]
test.Appl.data.30 = Appl.data.norm[1465:1494,]
fit.net.30 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI + Gold + Copper + TNYR + DXY + CQQQ + CAC40, data = train.Appl.data.7, hidden = c(5,3),  linear.output=FALSE)
plot(fit.net.30)
out.test.30 = compute(fit.net.30, test.Appl.data.30[,2:9])
# reverting to normal forecasting values
pred.30 = out.test.30$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.30 = Appl.data.nn[1465:1494,1]
ASE.nn.30 = sum((pred.30 -actual.30)^2)/nrow(test.Appl.data.30)
ASE.nn.30
plot(seq(1,130,1),Appl.data.nn$APPL[1365:1494], type = 'l', xlim = c(1,115))
lines(seq(101,130,1), pred.30, col = 'blue')
###====================================================================
### 7 days forecast of individual parameter using mlp (nueral net) ====
# APPL - 7days forecast
fit.mlp.APPL = mlp(APPL,reps = 50,comb = "mean")
head(Appl.data)
Appl.data.nn = Appl.data[,-1] ## removing Date
str(Appl.data.nn)
## Min-Max normalization of the dataset
Appl.data.norm = Appl.data.nn
for(i in 1:9){
Appl.data.norm[,i] = (Appl.data.nn[,i] - min(Appl.data.nn[,i]))/
(max(Appl.data.nn[,i]) -min(Appl.data.nn[,i]))
}
####    7 days ASE  ----------------------
train.Appl.data.7 = Appl.data.norm[1:1487,]
test.Appl.data.7 = Appl.data.norm[1488:1494,]
fit.net.7 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI +
Gold + Copper + TNYR + DXY + CQQQ + CAC40,
data = train.Appl.data.7, hidden = c(5,3),
linear.output=FALSE)
plot(fit.net.7)
out.test.7 = compute(fit.net.7, test.Appl.data.7[,2:9]) # prediction
## reverting the values by retrofiting the min-max normalization
pred.7 = out.test.7$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.7 = Appl.data.nn[1488:1494,1]
ASE.nn.7 = sum((pred.7 -actual.7)^2)/nrow(test.Appl.data.7)
ASE.nn.7
plot(seq(1,107,1),Appl.data.nn$APPL[1388:1494], type = 'l', xlim= c(1,115))
lines(seq(101,107,1), pred.7, col = 'blue')
####    30 days ASE   ---------------------------
train.Appl.data.30 = Appl.data.norm[1:1464,]
test.Appl.data.30 = Appl.data.norm[1465:1494,]
fit.net.30 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI + Gold + Copper + TNYR + DXY + CQQQ + CAC40, data = train.Appl.data.7, hidden = c(5,3),  linear.output=FALSE)
plot(fit.net.30)
out.test.30 = compute(fit.net.30, test.Appl.data.30[,2:9])
# reverting to normal forecasting values
pred.30 = out.test.30$net.result*(max(Appl.data.nn[,1]) -min(Appl.data.nn[,1]))+ min(Appl.data.nn[,1])
actual.30 = Appl.data.nn[1465:1494,1]
ASE.nn.30 = sum((pred.30 -actual.30)^2)/nrow(test.Appl.data.30)
ASE.nn.30
plot(seq(1,130,1),Appl.data.nn$APPL[1365:1494], type = 'l', xlim = c(1,115))
lines(seq(101,130,1), pred.30, col = 'blue')
###====================================================================
### 7 days forecast of individual parameter using mlp (nueral net) ====
# APPL - 7days forecast
fit.mlp.APPL = mlp(APPL$Adj.Close,reps = 50,comb = "mean")
head(Appl.data)
Appl.data.nn = Appl.data[,-1] ## removing Date
str(Appl.data.nn)
## Min-Max normalization of the dataset
Appl.data.norm = Appl.data.nn
for(i in 1:9){
Appl.data.norm[,i] = (Appl.data.nn[,i] - min(Appl.data.nn[,i]))/
(max(Appl.data.nn[,i]) -min(Appl.data.nn[,i]))
}
####    7 days ASE  ----------------------
train.Appl.data.7 = Appl.data.norm[1:1487,]
test.Appl.data.7 = Appl.data.norm[1488:1494,]
fit.net.7 = neuralnet::neuralnet(APPL ~ NASDAQ + WTI +
Gold + Copper + TNYR + DXY + CQQQ + CAC40,
data = train.Appl.data.7, hidden = c(5,3),
linear.output=FALSE)
plot(fit.net.7)
out.test.7 = compute(fit.net.7, test.Appl.data.7[,2:9]) # prediction
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
library(vars)
library(bigtime)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
fvx <- read.csv("kdata/FVX.csv")
ixic <- read.csv("kdata/IXIC.csv")
X = final %>% select(c(IXIC,FVX,Adj.Close,IRX))
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
library(vars)
library(bigtime)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
fvx <- read.csv("kdata/FVX.csv")
ixic <- read.csv("kdata/IXIC.csv")
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
library(vars)
library(bigtime)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
fvx <- read.csv("kdata/FVX.csv")
ixic <- read.csv("kdata/IXIC.csv")
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
View(irx)
ixic2 <- drop_na(ixic, Adj.Close)
View(ixic2)
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tswge)
library(vars)
library(bigtime)
apple <- read.csv("kdata/AAPL.csv")
irx <- read.csv("kdata/IRX.csv")
fvx <- read.csv("kdata/FVX.csv")
ixic <- read.csv("kdata/IXIC.csv")
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% select(c(Date, Adj.Close))
ixic %>% select(c(Date))
ixic %>% select(Date)
ixic$Adj.Close <- as.numeric(ixic$Adj.Close)
irx$Adj.Close <- as.numeric(irx$Adj.Close)
fvx$Adj.Close <- as.numeric(fvx$Adj.Close)
ixic2 <- drop_na(ixic, Adj.Close) %>% dplyr::select(c(Date, Adj.Close))
irx2 <- drop_na(irx, Adj.Close) %>% dplyr::select(c(Date, Adj.Close))
fvx2 <- drop_na(fvx, Adj.Close) %>% dplyr::select(c(Date, Adj.Close))
colnames(ixic2) <- c("Date", "IXIC")
colnames(irx2) <- c("Date", "IRX")
colnames(fvx2) <- c("Date", "FVX")
final = right_join(apple, irx2, by="Date")
final = right_join(final, fvx2, by="Date")
final = left_join(final, ixic2, by="Date")
final <- final %>% mutate(rel_yield = FVX/IRX)
X = final %>% dplyr::select(c(IXIC,FVX,Adj.Close,IRX))
VARselect(X, lag.max = 10, type="const")
arima_windowed_ASE = function(trainingSize, horizon, data) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
arima_windowed_ASE(70,7,X)
VAR_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
forecast = predict(fit, n.ahead=horizon)$fcst$Adj.Close[,1]
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
VAR_windowed_ASE(70, 7, X, 10)
ensemble_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit1 = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = (predict(fit1, n.ahead=horizon)$fcst$Adj.Close[,1] + predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred)/2
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
ensemble_windowed_ASE(70,7,X,9)
ensemble_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit1 = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = (predict(fit1, n.ahead=horizon)$fcst$Adj.Close[,1] + predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred)/2
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
ensemble_windowed_ASE(70,7,X,9)
arima_windowed_ASE = function(trainingSize, horizon, data) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
arima.7.windowedase = arima_windowed_ASE(70,7,X)
arima.30.windowedase = arima_windowed_ASE(70,30,X)
VAR_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
forecast = predict(fit, n.ahead=horizon)$fcst$Adj.Close[,1]
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
var.7.windowedase = VAR_windowed_ASE(70, 7, X, 10)
var.30.windowedase = VAR_windowed_ASE(70, 30, X, 10)
ensemble_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit1 = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = (predict(fit1, n.ahead=horizon)$fcst$Adj.Close[,1] + predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred)/2
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
ensemble.7.windowedase = ensemble_windowed_ASE(70,7,X,10)
ensemble.30windowedase = ensemble_windowed_ASE(70,30,X,10)
arima_windowed_ASE = function(trainingSize, horizon, data) {
len = dim(data)[1]
trainingSize = 70
horizon = 12
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
arima.7.windowedase = arima_windowed_ASE(120,7,X)
arima.30.windowedase = arima_windowed_ASE(120,30,X)
dim(X)
dim(X)[1]
arima_windowed_ASE = function(trainingSize, horizon, data) {
len = dim(data)[1]
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
arima.7.windowedase = arima_windowed_ASE(70,7,X)
arima.30.windowedase = arima_windowed_ASE(70,30,X)
VAR_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
forecast = predict(fit, n.ahead=horizon)$fcst$Adj.Close[,1]
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
var.7.windowedase = VAR_windowed_ASE(70, 7, X, 10)
var.30.windowedase = VAR_windowed_ASE(70, 30, X, 10)
arima_windowed_ASE = function(trainingSize, horizon, data) {
len = dim(data)[1]
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
arima.7.windowedase = arima_windowed_ASE(90,7,X)
arima.30.windowedase = arima_windowed_ASE(90,30,X)
VAR_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
forecast = predict(fit, n.ahead=horizon)$fcst$Adj.Close[,1]
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
var.7.windowedase = VAR_windowed_ASE(90, 7, X, 10)
var.30.windowedase = VAR_windowed_ASE(90, 30, X, 10)
ensemble_windowed_ASE = function(trainingSize, horizon, data, p) {
len = dim(data)[1]
ASEHolder = numeric()
for( i in 1:(len-(trainingSize + horizon) + 1))
{
fit1 = VAR(data[i:(i+(trainingSize-1)),], p = p, type="const")
fit2 = arima(data[i:(i+(trainingSize-1)),3], order=c(2,1,0),xreg = data[i:(i+(trainingSize-1)),-3])
forecast = (predict(fit1, n.ahead=horizon)$fcst$Adj.Close[,1] + predict(fit2,data[(trainingSize+i):(trainingSize+i+(horizon-1)),-3],n.ahead=horizon)$pred)/2
ASE = mean((data[(trainingSize+i):(trainingSize+ i + (horizon) - 1),3] - forecast)^2)
ASEHolder[i] = ASE
}
WindowedASE = mean(ASEHolder)
return(WindowedASE)
}
ensemble.7.windowedase = ensemble_windowed_ASE(90,7,X,10)
ensemble.30windowedase = ensemble_windowed_ASE(90,30,X,10)
